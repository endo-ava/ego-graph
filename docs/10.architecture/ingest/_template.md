# [データソース名] データソース設計

## 1. 概要

[データソースの簡単な説明]

### データの性質

- **タイプ**：[構造化ログ / 非構造化データ / 時系列・行動履歴]
- **粒度**：[Atomic / Summary / Chunk]
- **更新頻度**：[リアルタイム / 日次 / 週次 / 手動]
- **センシティビティ**：[Low / Medium / High]

---

## 2. 入力データ構造

[データの取得元と構造を記述]

### 2.1 基本情報

| フィールド | 説明 | 例 |
|---|---|---|
| `field_1` | フィールドの説明 | `"example_value"` |
| `field_2` | フィールドの説明 | `"example_value"` |

### 2.2 拡張情報（取得可能な場合）

| フィールド | 説明 | 例 |
|---|---|---|
| `optional_field` | オプションフィールドの説明 | `"value"` |

---

## 3. Semantification（文章化）戦略

※ 構造化データの場合のみ記述

### 3.1 基本テンプレート

**目的**：[テンプレートの目的]

**テンプレート形式**：

```
[テンプレート文字列]
```

**出力例**：

```
[実際の出力例]
```

### 3.2 テンプレート選択基準

| 条件 | 使用テンプレート | 理由 |
|---|---|---|
| [条件1] | [テンプレート名] | [理由] |
| [条件2] | [テンプレート名] | [理由] |

---

## 4. チャンキング戦略

※ 非構造化データの場合のみ記述

### 4.1 分割単位

[段落単位 / 文単位 / トークン数（例：512トークン）]

### 4.2 ウィンドウサイズ

[前後N文 / 前後Nトークン]

### 4.3 親子関係

[親ノード（元の文章全体）と子ノード（チャンク）の関係性を記述]

---

## 5. メタデータマッピング

Lexia標準スキーマへのマッピング：

### 5.1 基本属性

| Lexiaフィールド | [データソース]フィールド | 変換処理 |
|---|---|---|
| `source` | - | 固定値: `"[データソース名]"` |
| `category` | [フィールド] | [変換ロジック] |
| `timestamp` | [日時フィールド] | [変換処理] |
| `date_bucket` | [日時フィールド] | 日付部分のみ抽出 |

### 5.2 生成用生データ

`original_data`フィールドに格納する情報：

- [格納する情報のリスト]

### 5.3 階層・粒度

| フィールド | 値 | 説明 |
|---|---|---|
| `granularity` | `"[atomic/summary/chunk]"` | [説明] |
| `parent_id` | [親ノードID] | [親ノードとの関係] |

### 5.4 セキュリティ・制御

| フィールド | 判定ロジック |
|---|---|
| `sensitivity` | [判定条件] |
| `nsfw` | [判定条件] |
| `access_group` | [固定値または判定条件] |

---

## 6. 要約ノードの生成

※ 該当する場合のみ記述

### 6.1 目的

[要約ノードの目的を記述]

### 6.2 生成タイミング

[日次 / 週次 / リアルタイムなど]

### 6.3 要約の内容

[要約に含める情報を記述]

### 6.4 要約ノードのメタデータ

| フィールド | 値 |
|---|---|
| `granularity` | `"summary"` |
| [その他のフィールド] | [値] |

---

## 7. 検索シナリオ例

### 7.1 [シナリオ名1]

**質問**：「[ユーザーの質問例]」

**検索戦略**：

- フィルタ：[メタデータフィルタ]
- クエリ：[検索クエリ]
- 期待結果：[期待される検索結果]

### 7.2 [シナリオ名2]

**質問**：「[ユーザーの質問例]」

**検索戦略**：

- フィルタ：[メタデータフィルタ]
- クエリ：[検索クエリ]
- 期待結果：[期待される検索結果]

---

## 8. データ取り込みフロー

```
[データソース]
         ↓
    [処理1]
         ↓
    [処理2]
         ↓
    [処理3]
         ↓
    Qdrantへ保存
```

---

## 9. 実装時の考慮事項

### 9.1 [考慮事項1]

[説明]

### 9.2 [考慮事項2]

[説明]

### 9.3 将来拡張

[将来的に追加したい機能や改善点]

---

## 10. サンプルデータ

### 10.1 入力データ例

```json
{
  "field_1": "value",
  "field_2": "value"
}
```

### 10.2 変換後のTextNode（概念図）

```json
{
  "id": "uuid-...",
  "text": "[Semantification後のテキスト]",
  "metadata": {
    "source": "[データソース名]",
    "category": "[カテゴリ]",
    "timestamp": "[ISO8601]",
    "date_bucket": "[YYYY-MM-DD]",
    "original_data": "[元データのJSON文字列]",
    "granularity": "[atomic/summary/chunk]",
    "sensitivity": "[low/medium/high]",
    "nsfw": false,
    "access_group": "private"
  }
}
```

---

## 11. 次のステップ

### 実装順序

1. [ステップ1]
2. [ステップ2]
3. [ステップ3]

### テスト項目

- [ ] [テスト項目1]
- [ ] [テスト項目2]
- [ ] [テスト項目3]
